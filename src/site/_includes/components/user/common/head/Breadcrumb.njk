<!DOCTYPE html>
<html lang="zh">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>自动生成面包屑导航</title>
    <style>
        body {
            margin: 0;
            padding: 0;
        }

        .breadcrumb-container {
            width: 70%;
            position: absolute; /* 使用绝对定位 */
            right: 0; /* 对齐到右边 */
            top: 2px; /* 距离顶部2px */
        }

        .breadcrumb {
            display: flex;
            list-style: none;
            padding: 0; 
            margin: 0;
            background: transparent; 
            border-radius: 4px;
        }

        .breadcrumb-item {
            margin-right: 3px; 
            cursor: default; 
            position: relative; 
        }

        .breadcrumb-item:hover {
            text-decoration: underline; 
        }

        .breadcrumb-item:not(:last-child)::after {
            content: '>'; 
            margin-left: 3px; 
            margin-right: 3px; 
            color: #6c757d; 
        }

        .hidden-breadcrumb {
            display: none; /* 默认隐藏 */
            background: #e9ecef; /* 背景颜色 */
            padding: 10px;
            border-radius: 4px;
            width: 300px; /* 设置宽度 */
            position: absolute; /* 绝对定位 */
            right: 0; /* 靠右对齐 */
            top: 25px; /* 距离顶部25px */
            z-index: 1000; /* 确保在上层 */
        }

        .show-hidden-btn {
            cursor: pointer;
            margin-left: 3px; /* 和最后一个面包屑的间距 */
            text-decoration: underline;
            color: #007bff;
            display: inline-block; /* 设为块元素 */
            align-self: center; /* 垂直居中 */
        }
    </style>

<nav class="navbar">
    <div class="breadcrumb-container" id="breadcrumb-container">
        <ol class="breadcrumb" id="breadcrumb">
            <!-- 面包屑项将通过 JavaScript 自动生成 -->
        </ol>
        <span class="show-hidden-btn" id="show-hidden-btn">显示更多</span>
        <div class="hidden-breadcrumb" id="hidden-breadcrumb">
            <!-- 被隐藏的面包屑项 -->
        </div>
    </div>
</nav>

<script>
   

    function generateBreadcrumb() {
        const breadcrumb = document.getElementById('breadcrumb');
        const hiddenBreadcrumb = document.getElementById('hidden-breadcrumb');
        const pathParts = window.location.pathname.split('/').filter(part => part);
        let currentPath = '';

        // 创建面包屑项
        pathParts.forEach((part, index) => {
            currentPath += '/' + part; // 持续构建当前路径
            const item = document.createElement('li');
            item.className = 'breadcrumb-item';
            item.innerText = decodeURIComponent(part);
            breadcrumb.appendChild(item);
        });

        // 添加最后一个面包屑项表示当前页面
        const currentItem = document.createElement('li');
        currentItem.className = 'breadcrumb-item';
        currentItem.innerText = decodeURIComponent(pathParts[pathParts.length - 1] || '首页');
        breadcrumb.appendChild(currentItem);

        // 检查如果面包屑整体宽度超过70%时，将后续面包屑隐藏
        checkBreadcrumbWidth();
    }

    function checkBreadcrumbWidth() {
        const breadcrumbContainer = document.getElementById('breadcrumb-container');
        const breadcrumb = document.getElementById('breadcrumb');
        const hiddenBreadcrumb = document.getElementById('hidden-breadcrumb');
        const showHiddenBtn = document.getElementById('show-hidden-btn');
        const containerWidth = breadcrumbContainer.clientWidth;
        let totalWidth = 0;
        let excessItems = [];

        // 检查每个面包屑项的宽度
        const breadcrumbItems = breadcrumb.querySelectorAll('.breadcrumb-item');
        breadcrumbItems.forEach(item => {
            totalWidth += item.offsetWidth;
            // 如果总宽度小于等于容器宽度，则继续
            if (totalWidth <= containerWidth) {
                return;
            } else {
                // 如果超过阈值，隐藏此项并保存到隐藏数组
                item.style.display = 'none';
                excessItems.push(item.innerText);
            }
        });

        // 将隐藏的项添加到隐藏面包屑中
        if (excessItems.length > 0) {
            hiddenBreadcrumb.innerHTML = excessItems.map(item => `<span>${item}</span>`).join(', ');
            hiddenBreadcrumb.style.display = 'block'; // 显示隐藏面包屑
        } else {
            hiddenBreadcrumb.style.display = 'none'; // 隐藏面包屑
        }

        // 处理"显示更多"按钮
        showHiddenBtn.style.display = (excessItems.length > 0) ? 'inline' : 'none';
        showHiddenBtn.onclick = function () {
            hiddenBreadcrumb.style.display = hiddenBreadcrumb.style.display === 'block' ? 'none' : 'block';
            showHiddenBtn.innerText = hiddenBreadcrumb.style.display === 'block' ? '隐藏' : '显示更多';
        };
    }

    // 调用生成面包屑导航的函数
    generateBreadcrumb();
</script>

 
