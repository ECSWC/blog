
    <style>
        
        .toc {
            background: rgba(0, 0, 0, 0.8); /* 半透明背景 */
            backdrop-filter: blur(10px);          /* 磨砂效果 */
            padding: 10px;
            position: absolute;                    /* 绝对定位 */
            top: 10px;                             /* 悬浮在左上角 */
            right: 10px;                            /* 悬浮在左上角 */
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            display: none;                         /* 初始隐藏 */
        }

        .toc-title {
            font-weight: bold;
        }

        .toc-button {
            position: fixed;                       /* 固定定位 */
            top: 10px;
            right: 10px;
            z-index: 1000;                        /* 确保按钮在上面 */
        }

        .toc a {
            color: white;                          /* 字体颜色 */
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5); /* 阴影效果 */
        }

        .toc ul {
            list-style-type: none;                 /* 去掉列表标记 */
            padding-left: 15px;                    /* 缩进 */
        }

        .toc ul ul {
            margin-left: 10px;                     /* 进一步缩进子标题 */
        }
        
        
    </style>


<button class="toc-button" id="toggle-toc">
    <div>🗺️</div>
    <div style="font-size: 12px;">点击显示 TOC</div>
</button>

<aside>
    <div class="toc" id="toc-container">
        <div class="toc-title-container">
            <div class="toc-title">
                🗺️ 本页面包含的内容：
            </div>
        </div>
        <div class="toc-container">
            <ul id="toc-list"></ul>
        </div>
    </div>
</aside>


<script>
    document.addEventListener('DOMContentLoaded', function() {
        const tocList = document.getElementById('toc-list');
        const tocContainer = document.getElementById('toc-container');
        const toggleButton = document.getElementById('toggle-toc');

        // 只选择带类的 h2, h3, h4
        const headers = document.querySelectorAll('main h2[class], main h3[class], main h4[class]');

        // 创建 TOC 条目
        headers.forEach(function(header) {
            const title = header.innerText;
            const id = encodeURIComponent(title)
                .replace(/%20/g, '-')          // 替换 %20 为 -
                .replace(/[^\w-]+/g, '');      // 移除无效字符

            header.setAttribute('id', id); // 设置锚点 ID

            const level = header.tagName.toLowerCase(); // 获取标题级别
            const listItem = document.createElement('li');

            listItem.innerHTML = `<a href="#${id}">${title}</a>`; // 继续保持链接

            // 嵌套处理
            if (level === 'h3') {
                const h2Item = tocList.querySelector(`li > a[href="#${id.split('-')[0]}"]`);
                if (h2Item) {
                    const parentLi = h2Item.parentNode;
                    let sublist = parentLi.querySelector('ul');
                    if (!sublist) {
                        sublist = document.createElement('ul');
                        parentLi.appendChild(sublist);
                    }
                    sublist.appendChild(listItem);
                } else {
                    tocList.appendChild(listItem);
                }
            } else if (level === 'h4') {
                const h3Item = tocList.querySelector(`li ul li > a[href="#${id.split('-')[0]}"]`);
                if (h3Item) {
                    const parentLi = h3Item.parentNode;
                    let sublist = parentLi.querySelector('ul');
                    if (!sublist) {
                        sublist = document.createElement('ul');
                        parentLi.appendChild(sublist);
                    }
                    sublist.appendChild(listItem);
                }
            } else {
                tocList.appendChild(listItem);
            }
        });

        // 切换 TOC 显示和隐藏
        toggleButton.addEventListener('click', function() {
            if (tocContainer.style.display === "none" || tocContainer.style.display === "") {
                tocContainer.style.display = "block"; // 展开 TOC
                toggleButton.innerText = "隐藏 TOC"; // 修改按钮文本
            } else {
                tocContainer.style.display = "none"; // 隐藏 TOC
                toggleButton.innerText = "显示 TOC"; // 修改按钮文本
            }
        });
    });
</script>
