<aside>
    <div class="sidebar">
        <div class="sidebar-container">
            {% for imp in dynamics.sidebar.top %}
                {% include imp %}
            {% endfor %}
            
            <div class="toc-wrapper">
                <div class="toc-button" onclick="toggleToc()">+</div> <!-- 点击按钮 -->
                <div class="toc">
                    <div class="toc-title-container">
                        <div class="toc-title">
                            On this page
                        </div>
                    </div>
                    <!-- toc 内容将通过 JS 动态生成 -->
                </div>
            </div>

            {% for imp in dynamics.sidebar.bottom %}
                {% include imp %}
            {% endfor %}
        </div>
    </div>
</aside>

<style>
.toc {
    display: none; /* 默认隐藏 toc */
    width: 200px; /* 点击后宽度 */
    height: auto; /* 高度自动调整 */
    background-color: #f8f9fa; /* 背景颜色 */
    border: 1px solid #ccc; /* 边框 */
    position: fixed; /* 固定定位以便不被遮挡 */
    z-index: 99; /* z-index 值低于按钮 */
    right: 80px; /* 不与按钮重叠，距离右边的距离 */
    top: 100px; /* 与按钮的顶部位置一致 */
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); /* 添加阴影效果 */
}
</style>

<script>
function toggleToc() {
    var tocButton = document.querySelector('.toc-button');
    var toc = document.querySelector('.toc');

    // 获取所有 <h2>, <h3>, <h4> 标签
    var headers = document.querySelectorAll('h2, h3, h4');
    var tocContent = '';

    headers.forEach(function(header) {
        var titleText = header.innerText.trim();
        var hasIcon = header.querySelector('i') !== null; // 假设图标是 <i> 标签
        var isChinese = /[\u4e00-\u9fa5]/.test(titleText); // 判断是否包含中文

        // 不做任何过滤，直接添加到内容
        tocContent += `<div>${titleText}</div>`;
    });

    // 更新 toc 的内容并显示
    if (toc.style.display === "none" || toc.style.display === "") {
        toc.innerHTML = tocContent; // 填充提取的标题
        toc.style.display = "block"; // 显示 toc
        tocButton.innerHTML = "-"; // 更新按钮为关闭图标
    } else {
        toc.style.display = "none"; // 隐藏 toc
        tocButton.innerHTML = "+"; // 更新按钮为打开图标
    }
}

// 初始状态
document.querySelector('.toc').style.display = "none"; // 初始化时隐藏 toc
</script>
