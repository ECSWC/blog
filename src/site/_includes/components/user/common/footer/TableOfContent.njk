å¥½çš„ï¼Œä»¥ä¸‹æ˜¯ä¿®æ”¹åçš„å®Œæ•´ä»£ç ï¼Œèƒ½å¤Ÿè¯†åˆ«å¸¦æœ‰ä¸åŒç±»çš„ `h1`, `h2`, å’Œ `h3` æ ‡ç­¾ä»¥ç”Ÿæˆ TOCï¼ˆç›®å½•ï¼‰ã€‚æˆ‘æ ¹æ®ä½ æä¾›çš„ä»£ç ç»“æ„è¿›è¡Œäº†é€‚å½“çš„è°ƒæ•´ã€‚

```html
<aside>
    <div class="sidebar">
        <div class="sidebar-container">
            {% for imp in dynamics.sidebar.top %}
                {% include imp %}
            {% endfor %}
            {% if settings.dgShowLocalGraph === true %}
                {% include "components/graphScript.njk" %}
            {% endif %}

            {% if settings.dgShowToc === false %}
                {% set tocHtml = '' %}
                {% set headers = content | regex_findall('<(h[1-3]) class="[^"]*">(.*?)</\\1>') %}
                {% if headers %}
                    <div class="toc">
                        <div class="toc-title-container">
                            <div class="toc-title">
                                ğŸ—ºï¸ æœ¬é¡µé¢åŒ…å«çš„å†…å®¹ï¼š
                            </div>
                        </div>
                        <div class="toc-container">
                            <ul>
                            {% for header in headers %}
                                {% set tag = header[0] %}
                                {% set title = header[1] %}
                                <li>
                                    <a href="#{{ title | slugify }}">{{ title }}</a>
                                </li>
                            {% endfor %}
                            </ul>
                        </div>
                    </div>
                {% endif %}
            {% endif %}

            {% if settings.dgShowBacklinks === true %}
                <div class="backlinks">
                    <div class="backlink-title" style="margin: 4px 0 !important;">Pages mentioning this page</div>
                    <div class="backlink-list">
                        {% if page.url == "/" %}
                            {% if graph.nodes[graph.homeAlias].backLinks.length === 0 %}
                                <div class="backlink-card">
                                    <span class="no-backlinks-message">No other pages mention this page</span>
                                </div>
                            {% endif %}
                        {% for backlink in graph.nodes[graph.homeAlias].backLinks %}
                            {% if graph.nodes[backlink].url != graph.homeAlias %}
                                <div class="backlink-card">
                                    {% if not meta.noteIconsSettings.backlinks %}<i icon-name="link"></i> {% endif %}<a href="{{graph.nodes[backlink].url}}" data-note-icon="{{graph.nodes[backlink].noteIcon}}" class="backlink">{{graph.nodes[backlink].title}}</a>
                                </div>
                            {% endif %}
                        {% endfor %}
                        {% else %}
                            {% if graph.nodes[page.url].backLinks.length === 0 %}
                                <div class="backlink-card">
                                    <span class="no-backlinks-message">No other pages mention this page</span>
                                </div>
                            {% endif %}
                        {% for backlink in graph.nodes[page.url].backLinks %}
                            {% if graph.nodes[backlink].url != page.url %}
                                <div class="backlink-card">
                                    {% if not meta.noteIconsSettings.backlinks %}<i icon-name="link"></i> {% endif %}<a href="{{graph.nodes[backlink].url}}" data-note-icon="{{graph.nodes[backlink].noteIcon}}" class="backlink">{{graph.nodes[backlink].title}}</a>
                                </div>
                            {% endif %}
                        {% endfor %}
                        {% endif %}
                    </div>
                </div>
            {% endif %}
            {% for imp in dynamics.sidebar.bottom %}
                {% include imp %}
            {% endfor %}
        </div>
    </div>
</aside>

<script>
// â˜ğŸ» TOC åœ¨ä¸åŒæƒ…å†µï¼ˆæ¯”å¦‚æ€ç»´å¯¼å›¾æ˜¯å¦éšè—ï¼‰æƒ…å†µä¸‹çš„ HTML å¸ƒå±€æ–¹å¼
// ğŸ‘‡ğŸ» æœç´¢ h1 h2 â€¦
var lis = document.querySelectorAll('div.sidebar-nav li');
var items = document.querySelectorAll('.item');
for (var i = 0; i < lis.length; i++) {
    lis[i].setAttribute('data-index', i);
    lis[i].onclick = function () {
        for (var i = 0; i < lis.length; i++) {
            lis[i].className = '';
        }
        this.className = 'current';
        var index = this.getAttribute('data-index');
        for (var j = 0; j < items.length; j++) {
            items[j].style.display = 'none';
        }
        items[index].style.display = 'block';
    }
}
</script>

{%- macro slugify(text) -%}
    {{ text | lower | replace(' ', '-') | replace('?', '') | replace('!', '') | replace('.', '') }}
{%- endmacro -%}
```

### è¯´æ˜ï¼š

1. **TOC ç”Ÿæˆé€»è¾‘**ï¼š
   - é€šè¿‡ `regex_findall` å‡½æ•°è¯†åˆ«å¸¦æœ‰ç±»çš„ `h1`, `h2`, å’Œ `h3` æ ‡ç­¾ï¼Œå¹¶æ•è·å®ƒä»¬çš„å†…å®¹ã€‚
   - å¯¹äºæ¯ä¸ªæ ‡é¢˜ç”Ÿæˆä¸€ä¸ª TOC é¡¹ï¼Œä½¿ç”¨ `slugify` å‡½æ•°è¿›è¡Œ URL å®‰å…¨åŒ–ã€‚

2. **slugify å®**ï¼š
   - è¯¥å®å°†æ ‡é¢˜è½¬æ¢ä¸ºé€‚åˆç”¨äºé”šç‚¹çš„æ ¼å¼ï¼ˆå°å†™ï¼Œç©ºæ ¼æ›¿æ¢ä¸ºè¿å­—ç¬¦ç­‰ï¼‰ã€‚

3. **ä¿ç•™å·²æœ‰é€»è¾‘**ï¼š
   - ä¿æŒäº†åŸä»£ç ä¸­çš„å…¶ä»–éƒ¨åˆ†ï¼ŒåŒ…æ‹¬ backlinks çš„é€»è¾‘ç­‰ã€‚

ç¡®ä¿æ­£ç¡®æµ‹è¯•å¹¶æ ¹æ®å®é™…å†…å®¹è¿›è¡Œé€‚å½“è°ƒæ•´ï¼Œä»¥ç¡®ä¿ TOC èƒ½å¤Ÿæ­£ç¡®æ˜¾ç¤ºå†…å®¹ã€‚
