<aside>
    <div class="toc" id="toc-container">
        <div class="toc-title-container">
            <div class="toc-title">
                ğŸ—ºï¸ æœ¬é¡µé¢åŒ…å«çš„å†…å®¹ï¼š
            </div>
        </div>
        <div class="toc-container">
            <ul id="toc-list"></ul>
        </div>
    </div>
</aside>

<button class="toc-button" id="toggle-toc">æ˜¾ç¤º TOC</button>

<script>
// åˆ›å»ºTOCçš„JavaScripté€»è¾‘
document.addEventListener('DOMContentLoaded', function() {
    const tocList = document.getElementById('toc-list');
    const tocContainer = document.getElementById('toc-container');
    const toggleButton = document.getElementById('toggle-toc');
    const headers = document.querySelectorAll('main h2, main h3, main h4'); // é€‰å–æ‰€æœ‰ main å†…çš„ h2, h3, h4

    // åˆ›å»º TOC æ¡ç›®
    headers.forEach(function(header) {
        const title = header.innerText;
        const id = encodeURIComponent(title) // ç¼–ç æ•´ä¸ªæ ‡é¢˜
            .replace(/%20/g, '-')          // æ›¿æ¢ %20 ä¸º -
            .replace(/[^\w-]+/g, '');      // ç§»é™¤æ— æ•ˆå­—ç¬¦

        header.setAttribute('id', id); // è®¾ç½®é”šç‚¹ ID

        const listItem = document.createElement('li');
        listItem.innerHTML = `<a href="javascript:void(0);" onclick="scrollToTarget('${id}')">â¤· ${title}</a>`; // ä½¿ç”¨ â¤· ç¬¦å·

        tocList.appendChild(listItem); // æ·»åŠ åˆ° TOC
    });

    // åˆ‡æ¢ TOC çš„æ˜¾ç¤ºå’Œéšè—
    toggleButton.addEventListener('click', function() {
        if (tocContainer.style.display === "none" || tocContainer.style.display === "") {
            tocContainer.style.display = "block"; // å±•å¼€ TOC
            toggleButton.innerText = "éšè— TOC"; // ä¿®æ”¹æŒ‰é’®æ–‡æœ¬
        } else {
            tocContainer.style.display = "none"; // éšè— TOC
            toggleButton.innerText = "æ˜¾ç¤º TOC"; // ä¿®æ”¹æŒ‰é’®æ–‡æœ¬
        }
    });
});

// åˆ›å»ºæ»šåŠ¨å‡½æ•°
function scrollToTarget(id) {
    const targetElement = document.getElementById(id); // è·å–ç›®æ ‡å…ƒç´ 
    if (targetElement) {
        const offset = 70; // é¡¶éƒ¨åç§»é‡
        const elementPosition = targetElement.getBoundingClientRect().top + window.scrollY;
        const offsetPosition = elementPosition - offset; // è®¡ç®—æ»šåŠ¨ä½ç½®

        window.scrollTo({
            top: offsetPosition,
            behavior: 'smooth' // å¹³æ»‘æ»šåŠ¨
        });
    }
}
</script>

